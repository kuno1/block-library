!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=4)}({4:function(e,t,r){e.exports=r(5)},5:function(e,t){function r(e,t){return function(e){if(Array.isArray(e))return e}
/*!
 * wpdeps=wp-blocks,kbl,wp-block-editor, wp-element, wp-api-fetch, kbl-components-user-selector, kbl-components-post-selector
 */(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,l=[],o=!0,c=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(l.push(n.value),!t||l.length!==t);o=!0);}catch(e){c=!0,a=e}finally{try{o||null==r.return||r.return()}finally{if(c)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var a=wp.blocks.registerBlockType,l=wp.i18n,o=l.__,c=l.sprintf,i=wp.blockEditor,u=i.RichText,s=i.withColors,b=i.InspectorControls,m=i.PanelColorSettings,p=i.MediaUpload,f=i.MediaUploadCheck,d=wp.components,h=d.Button,g=d.PanelBody,v=d.SelectControl,y=d.TextControl,k=wp.element.useState,S=kbl,E=S.UserSelector,R=S.PostSelector,C={},w={},N=function(e){for(var t="",r=0,n=["thumbnail",KblBubble.size];r<n.length;r++){var a=n[r];e.sizes[a]&&(t=e.sizes[a].url)}return t},x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";wp.data.dispatch("core/notices").createNotice(t,e,{isDismissible:!0})};a("kunoichi/bubble",{title:o("Speech Bubble","kbl"),icon:"format-chat",category:"formatting",description:o("Speech bubble with avatar.","kbl"),attributes:{position:{type:"string",default:"left"},name:{type:"string",default:""},avatar:{type:"string",default:""},writer:{type:"integer",default:0},user:{type:"integer",default:0},textColor:{type:"string",default:""},backgroundColor:{type:"string",default:""},content:{type:"string",source:"html",selector:".kbl-bubble-text"}},edit:s("backgroundColor","textColor")((function(e){var t=e.attributes,n=e.setAttributes,a=e.backgroundColor,l=e.setBackgroundColor,i=e.textColor,s=e.setTextColor,d=r(k(KblBubble.avatar),2),S=d[0],O=d[1],_=r(k(""),2),B=_[0],j=_[1],P=B,T=S;if(t.user){var A=C[t.user];A?(P=A.display_name,T=A.avatar):wp.apiFetch({path:c("kbl/v1/users/search?id=%d",t.user)}).then((function(e){e.length?(C[t.user]=e[0],j(e[0].display_name),O(e[0].avatar)):(n({user:0}),x(o("User not found.","kbl"),"error"))})).catch((function(e){var t=o("Error","kbl");e.responseJSON&&e.responseJSON.message&&(t=e.responseJSON.message),x(t,"error")}))}else if(t.writer){var K=w[t.writer];K?(P=K.title,T=K.thumbnail):wp.apiFetch({path:c("kbl/v1/search/%1$s?id=%2$d",KblBubble.virtual_member,t.writer)}).then((function(e){e.length?(w[t.writer]=e[0],j(t.name?t.name:e[0].title),O(t.avatar?t.avatar:e[0].thumbnail)):(n({writer:0}),x(o("Post not found.","kbl"),"error"))})).catch((function(e){var t=o("Error","kbl");e.responseJSON&&e.responseJSON.message&&(t=e.responseJSON.message),x(t,"error")}))}t.name.length&&(P=t.name),t.avatar&&(T=t.avatar);var M=[{value:i.color,label:o("Text Color","kbl"),onChange:s},{value:a.color,label:o("Background Color","kbl"),onChange:l}],I=["kbl-bubble-text"],J={};return a.class?I.push(a.class):a.color&&(J.backgroundColor=a.color),i.class?I.push(i.class):i.color&&(J.color=i.color),React.createElement(React.Fragment,null,React.createElement(b,null,React.createElement(g,{title:o("Speaker","kbl"),initialOpen:!0},React.createElement("hr",{style:{marginTop:0}}),React.createElement("h4",{className:"kbl-user-heading"},o("Input Directly","kbl")),React.createElement(y,{label:o("Name","kbl"),value:t.name,help:o("If name is empty, this will be just omitted.","kbl"),onChange:function(e){return n({name:e})}}),React.createElement(f,null,React.createElement(p,{allowedTypes:["image"],onSelect:function(e){n({avatar:N(e)})},render:function(e){var r=e.open;return React.createElement(React.Fragment,null,React.createElement(h,{isSecondary:!0,onClick:r},o("Select Avatar","kbl")),t.avatar&&React.createElement(h,{style:{marginLeft:"10px"},isLink:!0,onClick:function(){return n({avatar:""})}},o("Clear Avatar","kbl")))}})),React.createElement("hr",null),React.createElement(E,{id:t.user,currentLabel:o("Specify WordPress User","kbl"),label:o("Search from WordPress users","kbl"),onChange:function(e){return n({user:e,writer:0})}}),KblBubble.virtual_member&&React.createElement(React.Fragment,null,React.createElement("hr",null),React.createElement(R,{id:t.writer,postType:KblBubble.virtual_member,currentLabel:c(o("Specify %s","kbl"),KblBubble.virtual_member_label),label:c(o("Search from %s","kbl"),KblBubble.virtual_member_label),onChange:function(e){return n({writer:e,user:0})}}))),React.createElement(g,{title:o("Layout","kbl"),initialOpen:!1},React.createElement(v,{label:o("Position","kbl"),value:t.position,options:[{label:o("Left","kbl"),value:"left"},{label:o("Right","kbl"),value:"right"}],onChange:function(e){n({position:e})}})),React.createElement(m,{title:o("Color Setting","kbl"),colorSettings:M,initialOpen:!1})),React.createElement("div",{className:"kbl-bubble","data-position":t.position},T?React.createElement("div",{className:"kbl-bubble-avatar"},React.createElement("img",{className:"kbl-bubble-image",src:T,alt:P,width:96,height:96}),P.length?React.createElement("span",{className:"kbl-bubble-name"},P):null):null,React.createElement("div",{className:"kbl-bubble-body"},React.createElement(u,{className:I.join(" "),style:J||null,tagName:"p",value:t.content,placeholder:o("Enter speech here.","kbl"),onChange:function(e){return n({content:e})}}))))})),save:function(e){var t=e.attributes;return React.createElement("div",{className:"kbl-bubble-body"},React.createElement(u.Content,{tagName:"p",className:"kbl-bubble-text",value:t.content}))}})}});
//# sourceMappingURL=bubble.js.map